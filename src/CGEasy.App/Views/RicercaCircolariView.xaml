<UserControl x:Class="CGEasy.App.Views.RicercaCircolariView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="ðŸ” Ricerca Circolari" 
                      FontSize="28" 
                      FontWeight="Bold" 
                      Foreground="#2c3e50"/>
            <TextBlock Text="Cerca, visualizza e gestisci le circolari archiviate" 
                      FontSize="14" 
                      Foreground="#7f8c8d" 
                      Margin="0,5,0,0"/>
        </StackPanel>

        <!-- FILTRI -->
        <Border Grid.Row="1" 
                Background="#f8f9fa" 
                BorderBrush="#dee2e6" 
                BorderThickness="1" 
                CornerRadius="8" 
                Padding="20" 
                Margin="0,0,0,15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Prima riga filtri -->
                <Grid Grid.Row="0" Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Argomento -->
                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                        <TextBlock Text="ðŸ“‚ Argomento" 
                                  FontSize="13" 
                                  FontWeight="SemiBold" 
                                  Foreground="#495057" 
                                  Margin="0,0,0,5"/>
                        <ComboBox ItemsSource="{Binding ArgomentiDisponibili}" 
                                 SelectedItem="{Binding ArgomentoFiltro}"
                                 DisplayMemberPath="Nome"
                                 FontSize="13" 
                                 Padding="10,8">
                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Padding" Value="10,8"/>
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>
                        <TextBlock Text="(vuoto = tutti)" 
                                  FontSize="10" 
                                  Foreground="#95a5a6" 
                                  FontStyle="Italic"
                                  Margin="2,3,0,0"/>
                    </StackPanel>

                    <!-- Anno -->
                    <StackPanel Grid.Column="1" Margin="0,0,15,0">
                        <TextBlock Text="ðŸ“… Anno" 
                                  FontSize="13" 
                                  FontWeight="SemiBold" 
                                  Foreground="#495057" 
                                  Margin="0,0,0,5"/>
                        <ComboBox ItemsSource="{Binding AnniDisponibili}" 
                                 SelectedItem="{Binding AnnoFiltro}"
                                 FontSize="13" 
                                 Padding="10,8">
                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Padding" Value="10,8"/>
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>
                        <TextBlock Text="(vuoto = tutti)" 
                                  FontSize="10" 
                                  Foreground="#95a5a6" 
                                  FontStyle="Italic"
                                  Margin="2,3,0,0"/>
                    </StackPanel>

                    <!-- Testo -->
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="ðŸ” Cerca testo" 
                                  FontSize="13" 
                                  FontWeight="SemiBold" 
                                  Foreground="#495057" 
                                  Margin="0,0,0,5"/>
                        <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                                FontSize="13" 
                                Padding="10,8"
                                ToolTip="Cerca in descrizione o nome file"/>
                    </StackPanel>
                </Grid>

                <!-- Pulsanti -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="ðŸ” Cerca" 
                           Command="{Binding CercaCommand}"
                           Background="#3498db" 
                           Foreground="White" 
                           Padding="25,10" 
                           FontSize="13" 
                           FontWeight="SemiBold"
                           BorderThickness="0"
                           Margin="0,0,10,0"
                           Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="Background" Value="#3498db"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#2980b9"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button Content="ðŸ”„ Reset" 
                           Command="{Binding ResetFiltriCommand}"
                           Background="#95a5a6" 
                           Foreground="White" 
                           Padding="25,10" 
                           FontSize="13" 
                           FontWeight="SemiBold"
                           BorderThickness="0"
                           Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="Background" Value="#95a5a6"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#7f8c8d"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- RISULTATI -->
        <Border Grid.Row="2" 
                Background="White" 
                BorderBrush="#dee2e6" 
                BorderThickness="1" 
                CornerRadius="8">
            <DataGrid ItemsSource="{Binding Circolari}" 
                     SelectedItem="{Binding CircolareSelezionata}"
                     AutoGenerateColumns="False" 
                     IsReadOnly="True"
                     CanUserAddRows="False"
                     CanUserDeleteRows="False"
                     CanUserResizeRows="False"
                     SelectionMode="Single"
                     GridLinesVisibility="Horizontal"
                     HeadersVisibility="Column"
                     RowHeight="50"
                     Background="White"
                     BorderThickness="0">

                <DataGrid.Columns>
                    <DataGridTextColumn Header="Anno" Binding="{Binding Anno}" Width="80"/>
                    <DataGridTextColumn Header="Argomento" Binding="{Binding ArgomentoNome}" Width="150"/>
                    <DataGridTextColumn Header="Descrizione" Binding="{Binding Descrizione}" Width="*"/>
                    <DataGridTextColumn Header="Nome File" Binding="{Binding NomeFile}" Width="200"/>
                    <DataGridTextColumn Header="Data Import" Binding="{Binding DataImportazione, StringFormat='dd/MM/yyyy HH:mm'}" Width="150"/>

                    <!-- Colonna Azioni -->
                    <DataGridTemplateColumn Header="Azioni" Width="250">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Content="ðŸ‘ï¸" 
                                           Command="{Binding DataContext.VisualizzaCircolareCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                           Background="#3498db" 
                                           Foreground="White" 
                                           Width="35" 
                                           Height="35"
                                           FontSize="14"
                                           BorderThickness="0"
                                           Margin="3,0"
                                           Cursor="Hand"
                                           ToolTip="Visualizza">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                                <Setter Property="Background" Value="#3498db"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#2980b9"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>

                                    <Button Content="âœï¸" 
                                           Command="{Binding DataContext.ModificaCircolareCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                           Background="#f39c12" 
                                           Foreground="White" 
                                           Width="35" 
                                           Height="35"
                                           FontSize="14"
                                           BorderThickness="0"
                                           Margin="3,0"
                                           Cursor="Hand"
                                           ToolTip="Modifica">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                                <Setter Property="Background" Value="#f39c12"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#e67e22"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>

                                    <Button Content="ðŸ—‘ï¸" 
                                           Command="{Binding DataContext.EliminaCircolareCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                           Background="#e74c3c" 
                                           Foreground="White" 
                                           Width="35" 
                                           Height="35"
                                           FontSize="14"
                                           BorderThickness="0"
                                           Margin="3,0"
                                           Cursor="Hand"
                                           ToolTip="Elimina">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                                <Setter Property="Background" Value="#e74c3c"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#c0392b"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</UserControl>

